<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Campañas - PulseCore</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

<nav class="navbar navbar-dark bg-danger">
  <div class="container-fluid">
    <span class="navbar-brand">Gestión de Campañas</span>
  </div>
</nav>

<div class="container mt-4">

  <div class="card mb-4" id="createSection">
    <div class="card-body">
      <h5>Nueva Campaña</h5>
      <form id="campaignForm">
        <input type="text" class="form-control mb-2" placeholder="Nombre" id="name" required>
        <textarea class="form-control mb-2" placeholder="Descripción" id="description"></textarea>
        <input type="date" class="form-control mb-2" id="start_date">
        <button class="btn btn-danger">Crear</button>
      </form>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered">
      <thead class="table-danger">
        <tr>
          <th>Nombre</th>
          <th>Descripción</th>
          <th>Fecha Inicio</th>
        </tr>
      </thead>
      <tbody id="campaignTable"></tbody>
    </table>
  </div>

</div>

<script>
const token = localStorage.getItem("token");
const role = localStorage.getItem("role");

if(role !== "ADMIN"){
  document.getElementById("createSection").style.display = "none";
}

async function loadCampaigns() {
  const response = await fetch("http://localhost:3000/campaigns", {
    headers: { Authorization: `Bearer ${token}` }
  });

  const campaigns = await response.json();
  campaignTable.innerHTML = "";

  campaigns.forEach(c => {
    campaignTable.innerHTML += `
      <tr>
        <td>${c.name}</td>
        <td>${c.description}</td>
        <td>${c.start_date}</td>
      </tr>
    `;
  });
}

loadCampaigns();
</script>

</body>
</html>